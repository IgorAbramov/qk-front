{"code":"!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=9)}([function(e){e.exports=tslib},function(e){e.exports=express},function(e){e.exports=express-formidable},function(e){e.exports=adminjs},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.convertToExpressRoute=void 0,t.convertToExpressRoute=(e=>e.replace(/{/g,\":\").replace(/}/g,\"\"))},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.buildRouter=void 0;const n=r(0),o=r(3),i=r(1),s=n.__importDefault(r(2)),u=n.__importDefault(r(16)),a=r(7),c=r(17),l=r(4);t.buildRouter=((e,t,r)=>{var n;if(\"AdminJS\"!==(null===(n=null==e?void 0:e.constructor)||void 0===n?void 0:n.name))throw new a.WrongArgumentError(\"You have to pass an instance of AdminJS to the buildRouter() function\");e.initialize().then(()=>{c.log.debug(\"AdminJS: bundle ready\")});const{routes:d,assets:f}=o.Router,p=null!=t?t:i.Router();return p.use(s.default(r)),d.forEach(t=>{const r=l.convertToExpressRoute(t.path),n=async(r,n,o)=>{try{const o=new t.Controller({admin:e},r.session&&r.session.adminUser),{params:i,query:s}=r,u=r.method.toLowerCase(),a=Object.assign(Object.assign({},r.fields||{}),r.files||{}),c=await o[t.action](Object.assign(Object.assign({},r),{params:i,query:s,payload:a,method:u}),n);t.contentType&&n.set({\"Content-Type\":t.contentType}),c&&n.send(c)}catch(e){i(e)}};\"GET\"===t.method&&p.get(r,n),\"POST\"===t.method&&p.post(r,n)}),f.forEach(e=>{p.get(e.path,async(t,r)=>{r.sendFile(u.default.resolve(e.src))})}),p})},function(e){function t(){throw new Error(\"setTimeout has not been defined\")}function r(){throw new Error(\"clearTimeout has not been defined\")}function n(e){if(a===setTimeout)return setTimeout(e,0);if((a===t||!a)&&setTimeout)return a=setTimeout,setTimeout(e,0);try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}function o(){p&&d&&(p=!1,d.length?f=d.concat(f):h=-1,f.length&&i())}function i(){if(!p){var e=n(o);p=!0;for(var t=f.length;t;){for(d=f,f=[];++h<t;)d&&d[h].run();h=-1,t=f.length}d=null,p=!1,function(e){if(c===clearTimeout)return clearTimeout(e);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var a,c,l=e.exports={};!function(){try{a=\"function\"==typeof setTimeout?setTimeout:t}catch(e){a=t}try{c=\"function\"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var d,f=[],p=!1,h=-1;l.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new s(e,t)),1!==f.length||p||n(i)},s.prototype.run=function(){this.fun.apply(null,this.array)},l.title=\"browser\",l.browser=!0,l.env={},l.argv=[],l.version=\"\",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.prependListener=u,l.prependOnceListener=u,l.listeners=function(){return[]},l.binding=function(){throw new Error(\"process.binding is not supported\")},l.cwd=function(){return\"/\"},l.chdir=function(){throw new Error(\"process.chdir is not supported\")},l.umask=function(){return 0}},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.OldBodyParserUsedError=t.WrongArgumentError=void 0;t.WrongArgumentError=class extends Error{constructor(e){super(e),this.name=\"WrongArgumentError\"}};t.OldBodyParserUsedError=class extends Error{constructor(e=\"\\n  You probably used old `body-parser` middleware, which is not compatible\\n  with @adminjs/express. In order to make it work you will have to\\n  1. move body-parser invocation after the AdminJS setup like this:\\n  \\n  const adminJs = new AdminJS()\\n  const router = new buildRouter(adminJs)\\n  app.use(adminJs.options.rootPath, router)\\n  \\n  // body parser goes after the AdminJS router\\n  app.use(bodyParser())\\n  \\n  2. Upgrade body-parser to the latest version and use it like this:\\n  app.use(bodyParser.json())\\n  \"){super(e),this.name=\"WrongArgumentError\"}}},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.name=void 0;const n=r(10),o=r(5);t.name=\"AdminJSExpressjs\",e.exports={name:t.name,buildAuthenticatedRouter:n.buildAuthenticatedRouter,buildRouter:o.buildRouter},t.default={name:t.name,buildAuthenticatedRouter:n.buildAuthenticatedRouter,buildRouter:o.buildRouter}},function(e,t,r){\"use strict\";r.r(t);var n=r(8);r.n(n);console.log({AdminJSExpress:n.AdminJSExpress})},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.buildAuthenticatedRouter=void 0;const n=r(0),o=n.__importDefault(r(1)),i=n.__importDefault(r(2)),s=n.__importDefault(r(11)),u=r(12),a=r(13),c=r(14),l=r(5),d=r(7);t.buildAuthenticatedRouter=((e,t,r,n,f)=>{const p=r||o.default.Router();return p.use((e,t,r)=>{e._body&&r(new d.OldBodyParserUsedError),r()}),p.use(s.default(Object.assign(Object.assign({},n),{secret:t.cookiePassword,name:t.cookieName||\"adminjs\"}))),p.use(i.default(f)),c.withProtectedRoutesHandler(p,e),u.withLogin(p,e,t),a.withLogout(p,e),l.buildRouter(e,p,f)})},function(e){e.exports=express-session},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.withLogin=void 0;class r{constructor(e){this.retriesCount=0;const t=r.retriesContainer.get(e);return t||void r.retriesContainer.set(e,this)}canLogin(e){if(void 0===e)return!0;if(\"number\"==typeof e)e={count:e,duration:60};else if(0>=e.count)return!0;return!this.lastRetry||(new Date).getTime()-this.lastRetry.getTime()>1e3*e.duration?(this.lastRetry=new Date,this.retriesCount=1,!0):(this.lastRetry=new Date,this.retriesCount++,this.retriesCount<=e.count)}}r.retriesContainer=new Map,t.withLogin=((e,t,n)=>{const{rootPath:o}=t.options,i=(e=>{const{loginPath:t,rootPath:r}=e.options,n=t.replace(r,\"\");return n.startsWith(\"/\")?n:`/${n}`})(t);e.get(i,async(e,r)=>{const n=await t.renderLogin({action:t.options.loginPath,errorMessage:null});r.send(n)}),e.post(i,async(e,i,s)=>{if(!new r(e.ip).canLogin(n.maxRetries)){const e=await t.renderLogin({action:t.options.loginPath,errorMessage:\"tooManyRequests\"});return void i.send(e)}const{email:u,password:a}=e.fields,c=await n.authenticate(u,a);if(c)e.session.adminUser=c,e.session.save(t=>{t&&s(t),e.session.redirectTo?i.redirect(302,e.session.redirectTo):i.redirect(302,o)});else{const e=await t.renderLogin({action:t.options.loginPath,errorMessage:\"invalidCredentials\"});i.send(e)}})})},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.withLogout=void 0;t.withLogout=((e,t)=>{const r=(e=>{const{logoutPath:t,rootPath:r}=e.options,n=t.replace(r,\"\");return n.startsWith(\"/\")?n:`/${n}`})(t);e.get(r,async(e,r)=>{e.session.destroy(()=>{r.redirect(t.options.loginPath)})})})},function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.isAdminRoute=t.withProtectedRoutesHandler=void 0;const n=r(3),o=r(4),i=r(15);t.withProtectedRoutesHandler=((e,r)=>{const{rootPath:n,loginPath:o,logoutPath:i}=r.options;e.use((e,r,u)=>{if(s(e.originalUrl))u();else if(e.session.adminUser||e.originalUrl.startsWith(o)||e.originalUrl.startsWith(i))u();else if(t.isAdminRoute(e.originalUrl,n)){const[t]=e.originalUrl.split(\"/actions\");e.session.redirectTo=t.includes(`${n}/api`)?n:t,e.session.save(e=>{e&&u(e),r.redirect(o)})}else u()})}),t.isAdminRoute=((e,t)=>{const r=n.Router.routes.map(e=>o.convertToExpressRoute(e.path)).filter(e=>\"\"!==e);let s=e;return\"/\"!==t&&(!(s=e.replace(t,\"\")).startsWith(\"/\")&&(s=`/${s}`)),e===t||!!r.find(e=>i.pathToRegexp(e).test(s))});const s=e=>n.Router.assets.find(t=>e.match(t.path))},function(e){function t(e,t){for(var r,n=[],s=0,u=0,a=\"\",c=t&&t.delimiter||l,f=t&&t.whitelist||void 0,p=!1;null!==(r=d.exec(e));){var h=r[0],g=r[1],m=r.index;if(a+=e.slice(u,m),u=m+h.length,g)a+=g[1],p=!0;else{var v=\"\",y=r[2],b=r[3],w=r[4],x=r[5];if(!p&&a.length){var R=a.length-1,E=a[R];(!f||-1<f.indexOf(E))&&(v=E,a=a.slice(0,R))}a&&(n.push(a),a=\"\",p=!1);var T=b||w,A=v||c;n.push({name:y||s++,prefix:v,delimiter:A,optional:\"?\"===x||\"*\"===x,repeat:\"+\"===x||\"*\"===x,pattern:T?i(T):\"[^\"+o(A===c?A:A+c)+\"]+?\"})}}return(a||u<e.length)&&n.push(a+e.substr(u)),n}function r(e,t){return function(r,n){var o=e.exec(r);if(!o)return!1;for(var i=o[0],s=o.index,u={},a=n&&n.decode||decodeURIComponent,c=1;c<o.length;c++)if(void 0!==o[c]){var l=t[c-1];u[l.name]=l.repeat?o[c].split(l.delimiter).map(function(e){return a(e,l)}):a(o[c],l)}return{path:i,index:s,params:u}}}function n(e,t){for(var r=Array(e.length),n=0;n<e.length;n++)\"object\"==typeof e[n]&&(r[n]=new RegExp(\"^(?:\"+e[n].pattern+\")$\",s(t)));return function(t,n){for(var o,i=\"\",s=n&&n.encode||encodeURIComponent,u=!n||!1!==n.validate,a=0;a<e.length;a++)if(\"string\"!=typeof(o=e[a])){var c,l=t?t[o.name]:void 0;if(Array.isArray(l)){if(!o.repeat)throw new TypeError('Expected \"'+o.name+'\" to not repeat, but got array');if(0===l.length){if(o.optional)continue;throw new TypeError('Expected \"'+o.name+'\" to not be empty')}for(var d=0;d<l.length;d++){if(c=s(l[d],o),u&&!r[a].test(c))throw new TypeError('Expected all \"'+o.name+'\" to match \"'+o.pattern+'\"');i+=(0===d?o.prefix:o.delimiter)+c}}else if(\"string\"!=typeof l&&\"number\"!=typeof l&&\"boolean\"!=typeof l){if(!o.optional)throw new TypeError('Expected \"'+o.name+'\" to be '+(o.repeat?\"an array\":\"a string\"))}else{if(c=s(l+\"\",o),u&&!r[a].test(c))throw new TypeError('Expected \"'+o.name+'\" to match \"'+o.pattern+'\", but got \"'+c+'\"');i+=o.prefix+c}}else i+=o;return i}}function o(e){return e.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g,\"\\\\$1\")}function i(e){return e.replace(/([=!:$/()])/g,\"\\\\$1\")}function s(e){return e&&e.sensitive?\"\":\"i\"}function u(e,r,n){return a(t(e,n),r,n)}function a(e,t,r){for(var n,i=(r=r||{}).strict,u=!1!==r.start,a=!1!==r.end,c=r.delimiter||l,d=[].concat(r.endsWith||[]).map(o).concat(\"$\").join(\"|\"),f=u?\"^\":\"\",p=0;p<e.length;p++)if(\"string\"==typeof(n=e[p]))f+=o(n);else{var h=n.repeat?\"(?:\"+n.pattern+\")(?:\"+o(n.delimiter)+\"(?:\"+n.pattern+\"))*\":n.pattern;t&&t.push(n),f+=n.optional?n.prefix?\"(?:\"+o(n.prefix)+\"(\"+h+\"))?\":\"(\"+h+\")?\":o(n.prefix)+\"(\"+h+\")\"}if(a)i||(f+=\"(?:\"+o(c)+\")?\"),f+=\"$\"===d?\"$\":\"(?=\"+d+\")\";else{var g=e[e.length-1],m=\"string\"==typeof g?g[g.length-1]===c:void 0===g;i||(f+=\"(?:\"+o(c)+\"(?=\"+d+\"))?\"),m||(f+=\"(?=\"+o(c)+\"|\"+d+\")\")}return new RegExp(f,s(r))}function c(e,t,r){return e instanceof RegExp?function(e,t){if(!t)return e;var r=e.source.match(/\\((?!\\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return e}(e,t):Array.isArray(e)?function(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(c(e[o],t,r).source);return new RegExp(\"(?:\"+n.join(\"|\")+\")\",s(r))}(e,t,r):u(e,t,r)}e.exports=c,e.exports.match=function(e,t){var n=[];return r(c(e,n,t),n)},e.exports.regexpToFunction=r,e.exports.parse=t,e.exports.compile=function(e,r){return n(t(e,r),r)},e.exports.tokensToFunction=n,e.exports.tokensToRegExp=a;var l=\"/\",d=new RegExp(\"(\\\\\\\\.)|(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?\",\"g\")},function(e,t,r){(function(e){function r(e,t){for(var r,n=0,o=e.length-1;0<=o;o--)\".\"===(r=e[o])?e.splice(o,1):\"..\"===r?(e.splice(o,1),n++):n&&(e.splice(o,1),n--);if(t)for(;n--;n)e.unshift(\"..\");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var o=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/,i=function(e){return o.exec(e).slice(1)};t.resolve=function(){for(var t,o=\"\",i=!1,s=arguments.length-1;-1<=s&&!i;s--){if(\"string\"!=typeof(t=0<=s?arguments[s]:e.cwd()))throw new TypeError(\"Arguments to path.resolve must be strings\");t&&(o=t+\"/\"+o,i=\"/\"===t.charAt(0))}return(i?\"/\":\"\")+(o=r(n(o.split(\"/\"),function(e){return!!e}),!i).join(\"/\"))||\".\"},t.normalize=function(e){var o=t.isAbsolute(e),i=\"/\"===s(e,-1);return(e=r(n(e.split(\"/\"),function(e){return!!e}),!o).join(\"/\"))||o||(e=\".\"),e&&i&&(e+=\"/\"),(o?\"/\":\"\")+e},t.isAbsolute=function(e){return\"/\"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,function(e){if(\"string\"!=typeof e)throw new TypeError(\"Arguments to path.join must be strings\");return e}).join(\"/\"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&\"\"===e[t];t++);for(var r=e.length-1;0<=r&&\"\"===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var o=n(e.split(\"/\")),i=n(r.split(\"/\")),s=Math.min(o.length,i.length),u=s,a=0;a<s;a++)if(o[a]!==i[a]){u=a;break}var c=[];for(a=u;a<o.length;a++)c.push(\"..\");return(c=c.concat(i.slice(u))).join(\"/\")},t.sep=\"/\",t.delimiter=\":\",t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):\".\"},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return i(e)[3]};var s=function(e,t,r){return e.substr(t,r)}}).call(this,r(6))},function(e,t,r){\"use strict\";(function(e){Object.defineProperty(t,\"__esModule\",{value:!0}),t.log=void 0,t.log={debug:t=>{e.env.ADMINJS_EXPRESS_DEBUG&&console.debug(t)}}}).call(this,r(6))}]);","extractedComments":[]}